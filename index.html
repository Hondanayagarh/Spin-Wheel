<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Spin Wheel Token Check</title>
</head>
<body>
  <h3>Enter Purchase Token</h3>
  <input id="tokenInput" placeholder="Enter token">
  <button onclick="checkToken()">Submit</button>
  <p id="msg" style="color:red"></p>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyjwF1_W7x_52piUobgAPfW59qcL7nF3k-VISNrydskQqx9Qpdbdj9BCufghuSfH3hZ/exec";

async function checkToken() {
  let token = document.getElementById("tokenInput").value.trim();
  if (!token) return;

  try {
    let res = await fetch(SCRIPT_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ token })
    });

    if (!res.ok) throw new Error("HTTP " + res.status);
    let data = await res.json();

    if (data.status === "valid") {
      document.getElementById("msg").style.color = "green";
      document.getElementById("msg").innerText = "‚úÖ Valid token! Spin unlocked.";
    } else if (data.status === "already") {
      document.getElementById("msg").style.color = "orange";
      document.getElementById("msg").innerText = "üéÅ Already used! You won: " + data.prize;
    } else {
      document.getElementById("msg").style.color = "red";
      document.getElementById("msg").innerText = "‚ùå Invalid token.";
    }

  } catch (err) {
    document.getElementById("msg").style.color = "red";
    document.getElementById("msg").innerText = "‚ö†Ô∏è Network error: " + err.message;
    console.error(err);
  }
}
</script>
</body>
</html>
